function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function t(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,n,i){return n&&t(e.prototype,n),i&&t(e,i),e}}(),DCFModal=function(){function t(e,n){_classCallCheck(this,t),this.modals=e,this.currentModal=null,this.currentBtn=null,this.body=document.querySelector("body"),this.nonModals=[];var i=document.getElementById("dcf-skip-nav"),o=document.getElementById("dcf-header"),a=document.getElementById("dcf-main"),d=document.getElementById("dcf-footer");i&&this.nonModals.push(i),o&&this.nonModals.push(o),a&&this.nonModals.push(a),d&&this.nonModals.push(d),this.disableBodyScroll=null,this.enableBodyScroll=null,n&&n.disableBodyScroll&&n.enableBodyScroll&&(this.disableBodyScroll=n.disableBodyScroll,this.enableBodyScroll=n.enableBodyScroll)}return _createClass(t,[{key:"appendToBody",value:function(t){this.body.appendChild(t)}},{key:"toggleModal",value:function(t,e){"false"===document.getElementById(t).getAttribute("aria-hidden")?this.closeModal(t):this.openModal(t,e)}},{key:"setNavToggleBtnState",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"open",n=t.getElementsByTagName("svg"),i=t.getElementsByClassName("dcf-nav-toggle-label");if(n.length){var o=n[DCFUtility.magicNumbers("int0")].getElementsByTagName("g");Array.from(o).forEach(function(t){t.classList.contains("dcf-nav-toggle-icon-open")?"open"===e.toLowerCase()?t.classList.remove("dcf-d-none"):t.classList.add("dcf-d-none"):t.classList.contains("dcf-nav-toggle-icon-close")&&("open"===e.toLowerCase()?t.classList.add("dcf-d-none"):t.classList.remove("dcf-d-none"))})}i.length&&("open"===e.toLowerCase()?i[DCFUtility.magicNumbers("int0")].textContent=t.getAttribute("data-nav-toggle-label-open")?t.getAttribute("data-nav-toggle-label-open"):"Open":i[DCFUtility.magicNumbers("int0")].textContent=t.getAttribute("data-nav-toggle-label-closed")?t.getAttribute("data-nav-toggle-label-closed"):"Close")}},{key:"openModal",value:function(t,e){var n=this,i=document.getElementById("dcf-nav-toggle-group"),o=i&&i.parentElement?i.parentElement:null;this.modals.forEach(function(e){e.getAttribute("id")!==t&&n.closeModal(e.getAttribute("id"))});var a=document.getElementById(t),d="false"===a.getAttribute("aria-hidden"),l=!1;if(e){this.currentBtn=e;var s=document.getElementById(e);l=s&&"true"===s.getAttribute("data-with-nav-toggle-group"),l&&this.setNavToggleBtnState(s,"closed")}if(this.currentModal=t,!d){this.nonModals.forEach(function(t){if(l&&i&&t===o){t.setAttribute("aria-hidden","false");o.childNodes.forEach(function(t){t.nodeType===Node.ELEMENT_NODE&&(t===i?t.setAttribute("aria-hidden","false"):t.setAttribute("aria-hidden","true"))})}else t.setAttribute("aria-hidden","true")}),this.disableBodyScroll&&this.disableBodyScroll(a,{allowTouchMove:function(t){for(var e=t;e&&e!==document.body;){if(e.classList.contains("dcf-modal-content")){var n={WebkitOverflowScrolling:"none",overflow:"hidden"};return Object.assign(document.body.style,n),!0}e.parentElement&&(e=e.parentElement)}return!1}}),this.body.classList.add("dcf-modal-is-open"),a.setAttribute("aria-hidden","false"),a.classList.remove("dcf-opacity-0","dcf-pointer-events-none","dcf-invisible"),a.classList.add("dcf-opacity-100","dcf-pointer-events-auto"),l&&a.classList.add("dcf-z-modal-behind-nav-toggle-group");var c=a.querySelectorAll('button:not([hidden]):not([disabled]), [href]:not([hidden]), input:not([hidden]):not([type="hidden"]):not([disabled]), select:not([hidden]):not([disabled]), textarea:not([hidden]):not([disabled]), [tabindex="0"]:not([hidden]):not([disabled]), summary:not([hidden]), [contenteditable]:not([hidden]), audio[controls]:not([hidden]), video[controls]:not([hidden])'),r=c[DCFUtility.magicNumbers("int0")],u=c[c.length-DCFUtility.magicNumbers("int1")];a.focus(),a.addEventListener("keydown",function(t){("Tab"===t.key||9===t.keyCode)&&("Tab"!==t.key&&9!==t.keyCode||(t.shiftKey?document.activeElement===r&&(t.preventDefault(),u.focus()):document.activeElement===u&&(t.preventDefault(),r.focus())))});var f="ModalOpenEvent_"+t;document.dispatchEvent(new CustomEvent(f))}}},{key:"closeModal",value:function(t){function e(){o.removeEventListener("transitionend",e),o.classList.contains("dcf-invisible")||o.classList.add("dcf-invisible")}var n=document.getElementById("dcf-nav-toggle-group"),i=n&&n.parentElement?n.parentElement:null,o=document.getElementById(t),a="true"===o.getAttribute("aria-hidden");if(this.currentModal=null,!a){if(this.body.classList.remove("dcf-modal-is-open"),this.currentBtn){var d=document.getElementById(this.currentBtn);d&&"true"===d.getAttribute("data-with-nav-toggle-group")&&this.setNavToggleBtnState(d,"open")}this.nonModals.forEach(function(t){if(n&&t===i){i.childNodes.forEach(function(t){t.nodeType===Node.ELEMENT_NODE&&t.setAttribute("aria-hidden","false")})}t.setAttribute("aria-hidden","false")}),o.setAttribute("aria-hidden","true"),o.classList.remove("dcf-opacity-100","dcf-pointer-events-auto","dcf-z-modal-behind-nav-toggle-group"),o.classList.add("dcf-opacity-0","dcf-pointer-events-none"),o.addEventListener("transitionend",e),this.currentBtn&&document.getElementById(this.currentBtn).focus(),this.enableBodyScroll&&this.enableBodyScroll(o);var l="ModalCloseEvent_"+t;document.dispatchEvent(new CustomEvent(l))}}},{key:"btnToggleListen",value:function(t,e,n){var i=this;t.addEventListener("click",function(){i.toggleModal(e,n)},!1)}},{key:"btnCloseListen",value:function(t,e){var n=this;t.addEventListener("click",function(){n.closeModal(e.getAttribute("id"))},!1)}},{key:"overlayListen",value:function(t,e){var n=this;t.addEventListener("click",function(i){e.contains(i.target)||n.closeModal(t.getAttribute("id"))})}},{key:"escListen",value:function(){var t=this;document.addEventListener("keydown",function(e){e.which===DCFUtility.magicNumbers("escCode")&&t.currentModal&&(e.preventDefault(),t.closeModal(t.currentModal))})}},{key:"initialize",value:function(){var t=this;if(this.modals){var e=document.querySelectorAll(".dcf-btn-toggle-modal"),n=document.querySelectorAll(".dcf-btn-close-modal"),i=document.querySelectorAll(".dcf-modal-wrapper"),o=document.querySelectorAll(".dcf-modal-content"),a=document.querySelectorAll(".dcf-modal-header");e.forEach(function(e){var n=e.getAttribute("data-toggles-modal"),i=DCFUtility.uuidv4();e.setAttribute("id",i),e.removeAttribute("disabled"),t.btnToggleListen(e,n,i)});for(var d=0;d<this.modals.length;d++){var l=this.modals[d],s=i[d],c=o[d],r=a[d],u=n[d],f=l.id,h=f+"-heading";r.querySelectorAll("h1, h2, h3, h4, h5, h6")[DCFUtility.magicNumbers("int0")].id=h,this.appendToBody(l),l.removeAttribute("hidden"),l.setAttribute("aria-labelledby",h),l.setAttribute("aria-hidden","true"),l.setAttribute("role","dialog"),l.setAttribute("tabindex","-1"),l.classList.length===DCFUtility.magicNumbers("int1")&&l.classList.contains("dcf-modal")&&l.classList.add("dcf-bg-overlay-dark"),l.classList.add("dcf-fixed","dcf-pin-top","dcf-pin-left","dcf-h-100%","dcf-w-100%","dcf-d-flex","dcf-ai-center","dcf-jc-center","dcf-opacity-0","dcf-pointer-events-none","dcf-invisible"),s.setAttribute("role","document"),s.classList.length===DCFUtility.magicNumbers("int1")&&s.classList.contains("dcf-modal-wrapper")&&s.classList.add("dcf-relative","dcf-h-auto","dcf-overflow-y-auto"),r.classList.length===DCFUtility.magicNumbers("int1")&&r.classList.contains("dcf-modal-header")&&r.classList.add("dcf-wrapper","dcf-pt-8","dcf-sticky","dcf-pin-top"),u.classList.length===DCFUtility.magicNumbers("int1")&&u.classList.contains("dcf-btn-close-modal")&&u.classList.add("dcf-btn","dcf-btn-tertiary","dcf-absolute","dcf-pin-top","dcf-pin-right","dcf-z-1"),c.classList.length===DCFUtility.magicNumbers("int1")&&c.classList.contains("dcf-modal-content")&&c.classList.add("dcf-wrapper","dcf-pb-8"),u.setAttribute("type","button"),u.setAttribute("aria-label","Close"),this.escListen(),this.overlayListen(l,s),this.btnCloseListen(u,l)}}}}]),t}();
//# sourceMappingURL=dcf-modal.js.map