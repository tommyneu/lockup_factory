function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(e,t){"function"==typeof define&&define.amd?define(["./dcf-uuidGen"],t):"object"===("undefined"==typeof exports?"undefined":_typeof(exports))?module.exports=t(require("./dcf-uuidGen")):e.dcfModal=t(e.dcfHelperUuidv4)}(void 0,function(e){return function(){function e(t,n){_classCallCheck(this,e),this.modals=t,this.disableBodyScroll=null,this.enableBodyScroll=null,n&&n.disableBodyScroll&&n.enableBodyScroll&&(this.disableBodyScroll=n.disableBodyScroll,this.enableBodyScroll=n.enableBodyScroll)}return _createClass(e,[{key:"appendToBody",value:function(e){document.querySelector("body").appendChild(e)}},{key:"toggleModal",value:function(e,t){"false"===document.getElementById(e).getAttribute("aria-hidden")?this.closeModal(e):this.openModal(e,t)}},{key:"setNavToggleBtnState",value:function(e,t){t=void 0!==t?t:"open";var n=e.getElementsByTagName("svg"),o=e.getElementsByClassName("dcf-nav-toggle-label");if(n.length)for(var d=n[0].getElementsByTagName("g"),a=0;a<d.length;a++)d[a].classList.contains("dcf-nav-toggle-icon-open")?"open"==t.toLowerCase()?d[a].classList.remove("dcf-d-none"):d[a].classList.add("dcf-d-none"):d[a].classList.contains("dcf-nav-toggle-icon-close")&&("open"==t.toLowerCase()?d[a].classList.add("dcf-d-none"):d[a].classList.remove("dcf-d-none"));o.length&&("open"==t.toLowerCase()?o[0].textContent=e.getAttribute("data-nav-toggle-label-open")?e.getAttribute("data-nav-toggle-label-open"):"Open":o[0].textContent=e.getAttribute("data-nav-toggle-label-closed")?e.getAttribute("data-nav-toggle-label-closed"):"Close")}},{key:"openModal",value:function(e,t){for(var n=document.querySelector("body"),o=document.getElementById("dcf-skip-nav"),d=document.getElementById("dcf-header"),a=document.getElementById("dcf-main"),l=document.getElementById("dcf-footer"),i=document.getElementById("dcf-nav-toggle-group"),s=i&&i.parentElement?i.parentElement:null,c=[o,d,a,l],r=0;r<this.modals.length;r++){var u=this.modals[r];u.getAttribute("id")!==e&&this.closeModal(u.getAttribute("id"))}var f=document.getElementById(e),g="false"===f.getAttribute("aria-hidden"),h=!1;if(t){this.currentBtn=t;var m=document.getElementById(t);h=m&&"true"===m.getAttribute("data-with-nav-toggle-group"),h&&this.setNavToggleBtnState(m,"closed")}if(this.currentModal=e,!g){for(var y=0;y<c.length;y++)if(h&&i&&c[y]===s){c[y].setAttribute("aria-hidden","false");for(var v=s.childNodes,b=0;b<v.length;b++)v[b].nodeType===Node.ELEMENT_NODE&&(v[b]===i?v[b].setAttribute("aria-hidden","false"):v[b].setAttribute("aria-hidden","true"))}else c[y].setAttribute("aria-hidden","true");this.disableBodyScroll&&this.disableBodyScroll(f),n.classList.add("dcf-modal-is-open"),f.setAttribute("aria-hidden","false"),f.classList.remove("dcf-opacity-0","dcf-pointer-events-none","dcf-invisible"),f.classList.add("dcf-opacity-100","dcf-pointer-events-auto"),h&&f.classList.add("dcf-z-modal-with-nav-toggle-group");var p=f.querySelectorAll('button:not([hidden]):not([disabled]), [href]:not([hidden]), input:not([hidden]):not([type="hidden"]):not([disabled]), select:not([hidden]):not([disabled]), textarea:not([hidden]):not([disabled]), [tabindex="0"]:not([hidden]):not([disabled]), summary:not([hidden]), [contenteditable]:not([hidden]), audio[controls]:not([hidden]), video[controls]:not([hidden])'),L=p[0],E=p[p.length-1];f.focus(),f.addEventListener("keydown",function(e){("Tab"===e.key||9===e.keyCode)&&("Tab"!==e.key&&9!==e.keyCode||(e.shiftKey?document.activeElement===L&&(e.preventDefault(),E.focus()):document.activeElement===E&&(e.preventDefault(),L.focus())))});var x="ModalOpenEvent_"+e;document.dispatchEvent(new CustomEvent(x))}}},{key:"closeModal",value:function(e){function t(){r.removeEventListener("transitionend",t),r.classList.contains("dcf-invisible")||r.classList.add("dcf-invisible")}var n=document.querySelector("body"),o=document.getElementById("dcf-skip-nav"),d=document.getElementById("dcf-header"),a=document.getElementById("dcf-main"),l=document.getElementById("dcf-footer"),i=document.getElementById("dcf-nav-toggle-group"),s=i&&i.parentElement?i.parentElement:null,c=[o,d,a,l],r=document.getElementById(e),u="true"===r.getAttribute("aria-hidden");if(this.currentModal=null,!u){if(n.classList.remove("dcf-modal-is-open"),this.currentBtn){var f=document.getElementById(this.currentBtn);f&&"true"===f.getAttribute("data-with-nav-toggle-group")&&this.setNavToggleBtnState(f,"open")}for(var g=0;g<c.length;g++){if(i&&c[g]===s)for(var h=s.childNodes,m=0;m<h.length;m++)h[m].nodeType===Node.ELEMENT_NODE&&h[m].setAttribute("aria-hidden","false");c[g].setAttribute("aria-hidden","false")}r.setAttribute("aria-hidden","true"),r.classList.remove("dcf-opacity-100","dcf-pointer-events-auto","z-modal-with-nav-toggle-group"),r.classList.add("dcf-opacity-0","dcf-pointer-events-none"),r.addEventListener("transitionend",t),this.currentBtn&&document.getElementById(this.currentBtn).focus(),this.enableBodyScroll&&this.enableBodyScroll(r);var y="ModalCloseEvent_"+e;document.dispatchEvent(new CustomEvent(y))}}},{key:"btnToggleListen",value:function(e,t,n){var o=this;e.addEventListener("click",function(){o.toggleModal(t,n)},!1)}},{key:"btnCloseListen",value:function(e,t){var n=this;e.addEventListener("click",function(){n.closeModal(t.getAttribute("id"))},!1)}},{key:"overlayListen",value:function(e,t){var n=this;e.addEventListener("click",function(o){t.contains(o.target)||n.closeModal(e.getAttribute("id"))})}},{key:"escListen",value:function(){var e=this;document.addEventListener("keydown",function(t){27===t.which&&e.currentModal&&(t.preventDefault(),e.closeModal(e.currentModal))})}},{key:"generateUUID",value:function(){var e=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var o=16*Math.random();return e>0?(o=(e+o)%16|0,e=Math.floor(e/16)):(o=(t+o)%16|0,t=Math.floor(t/16)),("x"===n?o:3&o|8).toString(16)})}},{key:"initialize",value:function(){if(this.modals){for(var e=(document.querySelector("body"),document.querySelectorAll(".dcf-btn-toggle-modal")),t=document.querySelectorAll(".dcf-btn-close-modal"),n=document.querySelectorAll(".dcf-modal-wrapper"),o=document.querySelectorAll(".dcf-modal-content"),d=document.querySelectorAll(".dcf-modal-header"),a=0;a<e.length;a++){var l=e[a],i=l.getAttribute("data-toggles-modal"),s=this.generateUUID();l.setAttribute("id",s),l.removeAttribute("disabled"),this.btnToggleListen(l,i,s)}for(var c=0;c<this.modals.length;c++){var r=this.modals[c],u=n[c],f=o[c],g=d[c],h=t[c],m=r.id,y=m+"-heading";g.querySelectorAll("h1, h2, h3, h4, h5, h6")[0].id=y,this.appendToBody(r),r.removeAttribute("hidden"),r.setAttribute("aria-labelledby",y),r.setAttribute("aria-hidden","true"),r.setAttribute("role","dialog"),r.setAttribute("tabindex","-1"),1===r.classList.length&&r.classList.contains("dcf-modal")&&r.classList.add("dcf-bg-overlay-dark"),r.classList.add("dcf-fixed","dcf-pin-top","dcf-pin-left","dcf-h-100%","dcf-w-100%","dcf-d-flex","dcf-ai-center","dcf-jc-center","dcf-opacity-0","dcf-pointer-events-none","dcf-invisible"),u.setAttribute("role","document"),1===u.classList.length&&u.classList.contains("dcf-modal-wrapper")&&u.classList.add("dcf-relative","dcf-h-auto","dcf-overflow-y-auto"),1===g.classList.length&&g.classList.contains("dcf-modal-header")&&g.classList.add("dcf-wrapper","dcf-pt-8","dcf-sticky","dcf-pin-top"),1===h.classList.length&&h.classList.contains("dcf-btn-close-modal")&&h.classList.add("dcf-btn","dcf-btn-tertiary","dcf-absolute","dcf-pin-top","dcf-pin-right","dcf-z-1"),1===f.classList.length&&f.classList.contains("dcf-modal-content")&&f.classList.add("dcf-wrapper","dcf-pb-8"),h.setAttribute("type","button"),h.setAttribute("aria-label","Close"),this.escListen(),this.overlayListen(r,u),this.btnCloseListen(h,r)}}}}]),e}()});
//# sourceMappingURL=dcf-modal.js.map